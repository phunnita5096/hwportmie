<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Mushroom Kingdom 3D</title>
  <style>
    body { margin: 0; overflow: hidden; }
    canvas { display: block; }
  </style>
</head>
<body>

<!-- ✅ โหลด Three.js + Loader -->
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/EXRLoader.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
<script>
  // ✅ สร้าง Scene
  const scene = new THREE.Scene();

  // ✅ กล้อง (ใกล้อาณาจักร)
  const camera = new THREE.PerspectiveCamera(
    60, window.innerWidth / window.innerHeight, 0.1, 2000
  );
  camera.position.set(5, 4, 8); // 👈 ใกล้มาก เห็นอาณาจักรเต็มตา
  camera.lookAt(0, 3, 0);

  // ✅ Renderer
  const renderer = new THREE.WebGLRenderer({ antialias: true });
  renderer.setSize(window.innerWidth, window.innerHeight);
  renderer.toneMapping = THREE.ACESFilmicToneMapping;
  renderer.toneMappingExposure = 1.0;
  renderer.outputEncoding = THREE.sRGBEncoding;
  document.body.appendChild(renderer.domElement);

  // ✅ Controls
  const controls = new THREE.OrbitControls(camera, renderer.domElement);
  controls.enableDamping = true;
  controls.dampingFactor = 0.05;
  controls.target.set(0, 3, 0);
  controls.update();

  // ✅ แสง
  const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
  scene.add(ambientLight);

  const dirLight = new THREE.DirectionalLight(0xffffff, 1.5);
  dirLight.position.set(20, 50, 20);
  dirLight.castShadow = true;
  scene.add(dirLight);
  
  // ✅ ลดความสว่าง
ambientLight.intensity = 0.2;       // ลด Ambient
dirLight.intensity = 0.8;          // ลด Directional
renderer.toneMappingExposure = 0.5; // ลดความสว่างทั้งหมด

  // ✅ โหลด Environment (EXR)
  const pmremGenerator = new THREE.PMREMGenerator(renderer);
  pmremGenerator.compileEquirectangularShader();

  const exrLoader = new THREE.EXRLoader();
  exrLoader.load("qwantani_night_puresky_1k.exr", (texture) => {
    const envMap = pmremGenerator.fromEquirectangular(texture).texture;
    scene.background = envMap;     
    scene.environment = envMap;    
    texture.dispose();
    pmremGenerator.dispose();
  });

  // ✅ โหลดโมเดล Mushroom Kingdom (.glb)
  const gltfLoader = new THREE.GLTFLoader();
  gltfLoader.load(
    "mushroom_kingdom_-_super_mario_galaxy-2.glb",
    (gltf) => {
      const model = gltf.scene;
      model.scale.set(1, 1, 1);
      model.position.set(0, 0, 0);
      scene.add(model);
      console.log("✅ Loaded Mushroom Kingdom");
    },
    (xhr) => {
      console.log(Math.round((xhr.loaded / xhr.total) * 100) + "% loaded");
    },
    (error) => {
      console.error("❌ Error loading GLB:", error);
    }
  );

// ✅ โหลดโมเดล name.glb เพิ่มเข้าไป (ไฟล์ของคุณ)
const loader2 = new THREE.GLTFLoader();
loader2.load(
  "name.glb",
  (gltf) => {
    const nameModel = gltf.scene;

    // ขนาด / ตำแหน่ง
    nameModel.scale.set(1, 1, 1);
    nameModel.position.set(-1, 4, 0); // ชิดซ้าย + สูง

    // ตั้งตรง: หมุนแกน X 90° (ถ้าโมเดลนอนราบ)
    nameModel.rotation.x = Math.PI / 2; // -90° ทำให้โมเดลตั้งขึ้น
    nameModel.rotation.y = 0;
    nameModel.rotation.z = 0;

    scene.add(nameModel);
    console.log("✅ Loaded name.glb (ตั้งตรง + ชิดซ้าย + ยกสูง)");
  },
  (xhr) => {
    console.log(Math.round((xhr.loaded / xhr.total) * 100) + "% loaded (name.glb)");
  },
  (error) => {
    console.error("❌ Error loading name.glb:", error);
  }
);


  // ✅ Render loop
  function render() {
    requestAnimationFrame(render);
    controls.update();
    renderer.render(scene, camera);
  }
  render();

  // ✅ Resize
  window.addEventListener("resize", () => {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
  });
</script>

</body>
</html>
